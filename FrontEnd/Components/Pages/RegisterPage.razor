@page "/Register"
@using FrontEnd.Infrastructure.UtilityMethods
@using Contracts
@using FrontEnd.Infrastructure
@inject IJSRuntime JsRuntime

<div class="bg-white w-full flex flex-col h-full">
    <form class="w-full flex flex-col gap-2 mt-16">
        @if (Step == 1)
        {
            <div class="w-1/4 mx-auto flex text-4xl font-semibold mb-4">
                <span class="mx-auto">Регистрирай се</span>
            </div>


            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Име: <span class="text-red">*</span>
                </label>
                <input id="Name" name="Name" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Фамилия: <span class="text-red">*</span>
                </label>
                <input id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Email: <span class="text-red">*</span>
                </label>
                <input id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Телефонен Номер: <span class="text-red">*</span>
                </label>
                <input id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Парола: <span class="text-red">*</span>
                </label>
                <input type="password" id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Повтори парола: <span class="text-red">*</span>
                </label>
                <input type="password" id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <button type="button" @onclick="() => Step++" class="bg-primary w-1/4 mx-auto rounded-lg text-white p-1 text-xl mt-8 pb-2 text-center align-middle items-center hover:bg-[#348aa7] transition-all">
                <span>Следваща стъпка</span>
            </button>
        }
        else if (Step == 2)
        {
            <div class="flex w-1/4 mx-auto gap-2">
                <div class="flex flex-col w-1/2 h-full">
                    <label for="Name" class="font-semibold">
                        Област: <span class="text-red">*</span>
                    </label>
                    <select @onchange="@OnSelectedRegion" id="Name" name="Name" class="bg-white rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none">
                        @{
                            foreach (var region in RegionsList)
                            {
                                <option class="bg-white" value="@region.RegionName">@region.RegionName</option>
                            }
                        }
                    </select>
                </div>

                <div class="flex flex-col w-1/2 h-full">
                    <label for="Name" class="font-semibold">
                        Град: <span class="text-red">*</span>
                    </label>
                    <select id="Name" name="Name" class="bg-white rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none">
                        @{
                            foreach (var city in RegionsList.FirstOrDefault(x => x.RegionName == Region)!.Cities)
                            {
                                <option class="bg-white" value="@city">@city</option>
                            }
                        }
                    </select>
                </div>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Образование: <span class="text-red">*</span>
                </label>
                <input id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Работа: <span class="text-red">*</span>
                </label>
                <input id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Професионален Опит: <span class="text-red">*</span>
                </label>
                <textarea rows="2"  id="Family" name="Family" class="resize-none rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Хобита/Умения: <span class="text-red">*</span>
                </label>
                <input id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Интереси/В търсене на: <span class="text-red">*</span>
                </label>
                <input id="Family" name="Family" class="rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <div class="flex flex-col w-1/4 mx-auto">
                <label for="Name" class="font-semibold">
                    Допълнителна информация: <span class="text-red">*</span>
                </label>
                <textarea rows="2"  id="Family" name="Family" class="resize-none rounded-md px-3 py-1 text-t-color border border-slate-300 focus:border-blue-500 focus:border focus:outline-none"/>
            </div>

            <button type="button" @onclick="OnSubmit" class="bg-green-700 w-1/4 mx-auto rounded-lg text-white p-1 text-xl mt-8 pb-2 text-center align-middle items-center hover:bg-green-600 transition-all">
                <span>@(this.loading ? "Изчакайте..." : "Приключи регистрация")</span>
            </button>
        }

    </form>
</div>


@code {
    protected override async Task OnInitializedAsync()
    {
        Step = 1;
        City = "София";
        Region = "София";
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        this.RegionsList = RegionsService.Regions;
        Console.WriteLine(RegionsList.Count);
    }

    void OnSelectedRegion(ChangeEventArgs e)
    {
        this.Region = e.Value.ToString();
    }
    
    async Task OnSubmit()
    {
        this.loading = true;

        await Task.Delay(1000);
        
        this.loading = false;
        await this.JsRuntime.ToastSuccess("Успешно се регистрирахте!");
    }

    int Step;
    bool loading;
    string City;
    string Region;
    List<Region> RegionsList;
}